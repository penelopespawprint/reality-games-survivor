services:
  - type: web
    name: rgfl-multi
    env: node
    plan: free
    repo: https://github.com/penelopespawprint/rgfl-multi
    branch: main
    buildCommand: npm install && npx prisma generate && npx prisma migrate deploy && npm run build
    startCommand: npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: DATABASE_URL
        sync: false  # Set in Render dashboard - never commit credentials
      - key: JWT_SECRET
        generateValue: true
      - key: PORT
        value: 5050
      - key: CLIENT_ORIGIN
        value: https://test.realitygamesfantasyleague.com,https://www.realitygamesfantasyleague.com,https://realitygamesfantasyleague.com
      - key: CLIENT_URL
        value: https://test.realitygamesfantasyleague.com
      - key: ENABLE_SETUP_ENDPOINT
        value: false
      # SimpleTexting SMS Configuration
      - key: SIMPLETEXTING_API_TOKEN
        sync: false
      - key: SIMPLETEXTING_ACCOUNT_PHONE
        sync: false
      - key: SIMPLETEXTING_BASE_URL
        value: https://api-app2.simpletexting.com/v2
      - key: SIMPLETEXTING_WEBHOOK_SECRET
        sync: false
      # SMS Features
      - key: SMS_REMINDER_ENABLED
        value: true
      - key: SMS_REMINDER_CRON
        value: "0 19 * * 3"
      - key: SMS_RATE_LIMIT_PER_USER_PER_DAY
        value: 10
      # Auth0 Configuration
      - key: VITE_AUTH0_DOMAIN
        value: dev-w01qewse7es4d0ue.us.auth0.com
      - key: VITE_AUTH0_CLIENT_ID
        value: yAEo8VblIwCANCgujhSQPqRYTCORR1H8
      # Email Configuration (Resend)
      - key: RESEND_API_KEY
        sync: false
      - key: EMAIL_FROM
        value: "RGFL <noreply@realitygamesfantasyleague.com>"
      - key: RESEND_SEASON_50_AUDIENCE_ID
        value: "05c96a85-4d13-4547-ad74-26e5ecfcc57b"
      # Registration Gate
      - key: REGISTRATION_OPEN_DATE
        value: "2025-01-05T00:00:00Z"
    healthCheckPath: /health
    autoDeploy: true
